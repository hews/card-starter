/*

FLIPPY jQuery plugin (http://guilhemmarty.com/flippy)

@author : Guilhem MARTY (bonjour@guilhemmarty.com)

@version: 1.0

@changelog:

Feb 11 2012 - v1.0.1 : bug fix with IE9

Feb 11 2012 - v1.0 : First release

*/(function($){function new_flippy(e){if(_isIE&&!_isIE9){$this.attr("id")==""&&$this.attr("id","flippy_container");var t=document.getElementById($this.attr("id")),n=document.createElement(e);t.appendChild(n)}else $this.append(e)}function drawFlippy(){_Ang+=_Step_ang,_Ang>90&&_Ang<=90+_Step_ang&&_Midway(),_Ang=_Ang>180+_Step_ang?_Ang-(180+_Step_ang):_Ang;var e=Math.PI,t=_Ang/180*e,n=document.getElementById("flippy");_isIE&&!_isIE9&&G_vmlCanvasManager.initElement(n);var r=n.getContext("2d");r.clearRect(0,0,_W+2*_CenterX,_H+2*_CenterY),r.beginPath();var i=Math.sin(t)*_H*_Depth,s=Math.sin(t)*_W*_Depth;switch(_Direction){case"LEFT":var o=Math.cos(t)*(_W/2);r.fillStyle=_Ang>90?changeColor(_Color_target,Math.floor(Math.sin(t)*_Light)):changeColor(_Color,-Math.floor(Math.sin(t)*_Light)),r.moveTo(_CenterX-o,_CenterY+i),r.lineTo(_CenterX+o,_CenterY-i),r.lineTo(_CenterX+o,_CenterY+_H+i),r.lineTo(_CenterX-o,_CenterY+_H-i),r.lineTo(_CenterX-o,_CenterY),r.fill();break;case"RIGHT":var o=Math.cos(t)*(_W/2);r.fillStyle=_Ang>90?changeColor(_Color_target,-Math.floor(Math.sin(t)*_Light)):changeColor(_Color,Math.floor(Math.sin(t)*_Light)),r.moveTo(_CenterX+o,_CenterY+i),r.lineTo(_CenterX-o,_CenterY-i),r.lineTo(_CenterX-o,_CenterY+_H+i),r.lineTo(_CenterX+o,_CenterY+_H-i),r.lineTo(_CenterX+o,_CenterY),r.fill();break;case"TOP":var u=Math.cos(t)*(_H/2);r.fillStyle=_Ang>90?changeColor(_Color_target,-Math.floor(Math.sin(t)*_Light)):changeColor(_Color,Math.floor(Math.sin(t)*_Light)),r.moveTo(_CenterX+s,_CenterY-u),r.lineTo(_CenterX-s,_CenterY+u),r.lineTo(_CenterX+_W+s,_CenterY+u),r.lineTo(_CenterX+_W-s,_CenterY-u),r.lineTo(_CenterX,_CenterY-u),r.fill();break;case"BOTTOM":var u=Math.cos(t)*(_H/2);r.fillStyle=_Ang>90?changeColor(_Color_target,Math.floor(Math.sin(t)*_Light)):changeColor(_Color,-Math.floor(Math.sin(t)*_Light)),r.moveTo(_CenterX+s,_CenterY+u),r.lineTo(_CenterX-s,_CenterY-u),r.lineTo(_CenterX+_W+s,_CenterY-u),r.lineTo(_CenterX+_W-s,_CenterY+u),r.lineTo(_CenterX,_CenterY+u),r.fill()}_Ang<180?setTimeout(drawFlippy,_Refresh_rate):(_Active=null,$this.css({background:_Color_target}).append(_Content).find("#flippy").remove(),$this.attr("id")=="flippy_container"&&$this.attr("id",""),_After())}function convertColor(thecolor){try{thecolor=eval("_ColorsRef."+thecolor)!=null?eval("_ColorsRef."+thecolor):thecolor}catch(err){}return thecolor.substr(0,4)=="rgb("&&(thecolor="#"+toHex(eval(thecolor.substr(4,thecolor.length).split(",")[0]))+toHex(eval(thecolor.substr(3,thecolor.length).split(",")[1]))+toHex(eval(thecolor.substr(3,thecolor.length-4).split(",")[2]))),thecolor}function toDec(hex){var hexL=hex.length,dec=0;for(i=0;i<hexL;i++){var hexPow=Math.pow(16,hexL-i-1),daHex=hex.substr(i,1);switch(daHex.toUpperCase()){case"A":dec+=10*hexPow;break;case"B":dec+=11*hexPow;break;case"C":dec+=12*hexPow;break;case"D":dec+=13*hexPow;break;case"E":dec+=14*hexPow;break;case"F":dec+=15*hexPow;break;default:dec+=eval(daHex)*hexPow}}return dec}function toHex(e){var t=new Array;while(Math.floor(e)>16)t.push(e%16),e=Math.floor(e/16);var n;switch(e){case 10:n="A";break;case 11:n="B";break;case 12:n="C";break;case 13:n="D";break;case 14:n="E";break;case 15:n="F";break;default:n=""+e}for(i=t.length-1;i>=0;i--)switch(t[i]){case 10:n+="A";break;case 11:n+="B";break;case 12:n+="C";break;case 13:n+="D";break;case 14:n+="E";break;case 15:n+="F";break;default:n+=""+t[i]}return n.length==1?"0"+n:n}function changeColor(e,t){var n=e.substr(1,2),r=e.substr(3,2),i=e.substr(5,2),s=toDec(n)+t>255?255:toDec(n)+t,o=toDec(r)+t>255?255:toDec(r)+t,u=toDec(i)+t>255?255:toDec(i)+t;return n=s<=0?"00":toHex(s),r=o<=0?"00":toHex(o),i=u<=0?"00":toHex(u),"#"+n+r+i}var _Ang,_Step_ang,_Refresh_rate,_Depth,_W,_H,_nW,_nH,_cv_W,_cv_H,_CenterX,_CenterY,_Color,_Color_target,_Light,_Content,_Direction,_Midway,$this,_After,_Active,_ColorsRef={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo  ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};$.fn.flippy=function(e){if(!_Active){e=$.extend({active_class:"flippy-active",step_ang:10,refresh_rate:15,duration:300,depth:.12,color_target:"white",light:60,content:"",direction:"LEFT",onStart:function(){},onMidway:function(){},onFinish:function(){}},e),_Active_class="flippy-active",_Active=_Active?_Active:"",_Ang=0,_Step_ang=e.refresh_rate/e.duration*200,_Refresh_rate=e.refresh_rate,_Depth=e.depth,_W="",_H="",_nW="",_nH="",_CenterX=_CenterX!=""?_CenterX:"",_CenterY=_CenterY!=""?_CenterY:"",_Color=_Color!=""?_Color:"",_Color_target=convertColor(e.color_target),_Direction=e.direction,_Light=e.light,_Content=e.content,_Before=e.onStart,_Midway=e.onMidway,_After=e.onFinish,_isIE=$.browser.msie,_isIE9=$.browser.version=="9.0",_isIE8=$.browser.version=="8.0",_isIE7=$.browser.version=="7.0",_isIE6=$.browser.version=="6.0";var t=1;return this.each(function(){$this=$(this),_nW=$this.width(),_nH=$this.height(),_W=$this.outerWidth(),_H=$this.outerHeight(),_Active=!0,_Before(),_Content=typeof _Content=="object"?_Content.html():_Content,_Color=convertColor($this.css("background-color")),$this.empty().data("color",$this.css("background-color")).css({background:"none",position:"relative",overflow:"visible"});switch(_Direction){case"TOP":_CenterX=Math.sin(Math.PI/2)*_nW*_Depth,_CenterY=_H/2;var e='<canvas id="flippy" width="'+(_W+2*_CenterX)+'" height="'+_H+'"></canvas>';new_flippy(e),$this.find("#flippy").css({position:"absolute",top:"0",left:"-"+_CenterX+"px"});break;case"BOTTOM":_CenterX=Math.sin(Math.PI/2)*_nW*_Depth,_CenterY=_H/2;var e='<canvas id="flippy" width="'+(_W+2*_CenterX)+'" height="'+_H+'"></canvas>';new_flippy(e),$this.find("#flippy").css({position:"absolute",top:"0",left:"-"+_CenterX+"px"});break;case"LEFT":_CenterY=Math.sin(Math.PI/2)*_nH*_Depth,_CenterX=_W/2;var e='<canvas id="flippy" width="'+_W+'" height="'+(_H+2*_CenterY)+'"></canvas>';new_flippy(e),$this.find("#flippy").css({position:"absolute",top:"-"+_CenterY+"px",left:"0"});break;case"RIGHT":_CenterY=Math.sin(Math.PI/2)*_nH*_Depth,_CenterX=_W/2;var e='<canvas id="flippy" width="'+_W+'" height="'+(_H+2*_CenterY)+'"></canvas>';new_flippy(e),$this.find("#flippy").css({position:"absolute",top:"-"+_CenterY+"px",left:"0"})}drawFlippy()})}}})(jQuery);